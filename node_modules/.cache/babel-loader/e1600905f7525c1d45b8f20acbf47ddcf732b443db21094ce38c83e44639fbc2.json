{"ast":null,"code":"import React,{useState,useEffect,forwardRef}from\"react\";import JsonRenderer from\"../JsonElem/JsonRenderer\";import SubTabsContainer from\"../SubTabsContainer/SubTabsContainer\";import styles from\"./TabsContainer.module.css\";import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";const API_BASE=process.env.REACT_APP_API_URL||'/api';function buildApiUrl(path){if(!path)return null;if(path.startsWith('http')||path.startsWith('/api'))return path;// Приводим путь к виду \"npcs/curators\"\nconst clean=path.replace(/^\\.?\\/*jsons\\//,'')// убираем jsons/ или ./jsons/\n.replace(/\\.json$/,'')// убираем расширение\n.replace(/^\\/+/,'');// убираем ведущие слэши\nreturn\"\".concat(API_BASE,\"/\").concat(clean);}const TabsContainer=/*#__PURE__*/forwardRef((_ref,ref)=>{let{tabPaths,subTabsExist=true}=_ref;const[activeTab,setActiveTab]=useState(0);const[tabData,setTabData]=useState([]);const[error,setError]=useState(null);useEffect(()=>{if(!tabPaths||tabPaths.length===0)return;const paths=Array.isArray(tabPaths)?tabPaths:[tabPaths];Promise.all(paths.map(async path=>{const url=buildApiUrl(path);try{const res=await fetch(url);if(!res.ok)throw new Error(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0438: \".concat(res.status,\" (\").concat(url,\")\"));return await res.json();}catch(err){console.error('Ошибка при загрузке:',err);return null;}})).then(data=>{const valid=data.filter(Boolean);if(valid.length===0)setError('Не удалось загрузить данные');setTabData(valid);}).catch(err=>setError(err.message));},[tabPaths]);const loadedTabs=tabData;if(error)return/*#__PURE__*/_jsxs(\"p\",{className:styles.error,children:[\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430: \",error]});if(!loadedTabs||loadedTabs.length===0)return/*#__PURE__*/_jsx(\"p\",{className:styles.loading,children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"});const showSubTabs=subTabsExist&&loadedTabs[activeTab];const showTopTabs=loadedTabs.length>1;return/*#__PURE__*/_jsxs(\"div\",{ref:ref,className:styles.container,children:[showTopTabs&&/*#__PURE__*/_jsx(\"div\",{className:styles.tabs,children:loadedTabs.map((tab,index)=>/*#__PURE__*/_jsx(\"button\",{className:activeTab===index?styles.active:\"\",onClick:()=>setActiveTab(index),children:tab.title},index))}),showSubTabs&&/*#__PURE__*/_jsx(SubTabsContainer,{data:loadedTabs[activeTab]}),/*#__PURE__*/_jsx(\"div\",{className:styles.content,children:loadedTabs[activeTab]?/*#__PURE__*/_jsx(JsonRenderer,{data:loadedTabs[activeTab]}):/*#__PURE__*/_jsx(\"p\",{children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"})})]});});export default TabsContainer;","map":{"version":3,"names":["React","useState","useEffect","forwardRef","JsonRenderer","SubTabsContainer","styles","jsxs","_jsxs","jsx","_jsx","API_BASE","process","env","REACT_APP_API_URL","buildApiUrl","path","startsWith","clean","replace","concat","TabsContainer","_ref","ref","tabPaths","subTabsExist","activeTab","setActiveTab","tabData","setTabData","error","setError","length","paths","Array","isArray","Promise","all","map","url","res","fetch","ok","Error","status","json","err","console","then","data","valid","filter","Boolean","catch","message","loadedTabs","className","children","loading","showSubTabs","showTopTabs","container","tabs","tab","index","active","onClick","title","content"],"sources":["C:/Users/jacke/WebstormProjects/jack_casino/src/elements/TabsContainer/TabsContainer.jsx"],"sourcesContent":["import React, { useState, useEffect, forwardRef } from \"react\";\r\nimport JsonRenderer from \"../JsonElem/JsonRenderer\";\r\nimport SubTabsContainer from \"../SubTabsContainer/SubTabsContainer\";\r\nimport styles from \"./TabsContainer.module.css\";\r\n\r\nconst API_BASE = process.env.REACT_APP_API_URL || '/api';\r\n\r\nfunction buildApiUrl(path) {\r\n    if (!path) return null;\r\n\r\n    if (path.startsWith('http') || path.startsWith('/api')) return path;\r\n\r\n    // Приводим путь к виду \"npcs/curators\"\r\n    const clean = path\r\n        .replace(/^\\.?\\/*jsons\\//, '')   // убираем jsons/ или ./jsons/\r\n        .replace(/\\.json$/, '')          // убираем расширение\r\n        .replace(/^\\/+/, '');            // убираем ведущие слэши\r\n\r\n    return `${API_BASE}/${clean}`;\r\n}\r\n\r\nconst TabsContainer = forwardRef(({ tabPaths, subTabsExist = true }, ref) => {\r\n    const [activeTab, setActiveTab] = useState(0);\r\n    const [tabData, setTabData] = useState([]);\r\n    const [error, setError] = useState(null);\r\n\r\n    useEffect(() => {\r\n        if (!tabPaths || tabPaths.length === 0) return;\r\n\r\n        const paths = Array.isArray(tabPaths) ? tabPaths : [tabPaths];\r\n\r\n        Promise.all(\r\n            paths.map(async (path) => {\r\n                const url = buildApiUrl(path);\r\n                try {\r\n                    const res = await fetch(url);\r\n                    if (!res.ok) throw new Error(`Ошибка загрузки: ${res.status} (${url})`);\r\n                    return await res.json();\r\n                } catch (err) {\r\n                    console.error('Ошибка при загрузке:', err);\r\n                    return null;\r\n                }\r\n            })\r\n        )\r\n            .then((data) => {\r\n                const valid = data.filter(Boolean);\r\n                if (valid.length === 0) setError('Не удалось загрузить данные');\r\n                setTabData(valid);\r\n            })\r\n            .catch((err) => setError(err.message));\r\n    }, [tabPaths]);\r\n\r\n    const loadedTabs = tabData;\r\n\r\n    if (error) return <p className={styles.error}>Ошибка: {error}</p>;\r\n    if (!loadedTabs || loadedTabs.length === 0) return <p className={styles.loading}>Загрузка...</p>;\r\n\r\n    const showSubTabs = subTabsExist && loadedTabs[activeTab];\r\n    const showTopTabs = loadedTabs.length > 1;\r\n\r\n    return (\r\n        <div ref={ref} className={styles.container}>\r\n            {showTopTabs && (\r\n                <div className={styles.tabs}>\r\n                    {loadedTabs.map((tab, index) => (\r\n                        <button\r\n                            key={index}\r\n                            className={activeTab === index ? styles.active : \"\"}\r\n                            onClick={() => setActiveTab(index)}\r\n                        >\r\n                            {tab.title}\r\n                        </button>\r\n                    ))}\r\n                </div>\r\n            )}\r\n\r\n            {showSubTabs && <SubTabsContainer data={loadedTabs[activeTab]} />}\r\n\r\n            <div className={styles.content}>\r\n                {loadedTabs[activeTab] ? (\r\n                    <JsonRenderer data={loadedTabs[activeTab]} />\r\n                ) : (\r\n                    <p>Загрузка...</p>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n});\r\n\r\nexport default TabsContainer;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}